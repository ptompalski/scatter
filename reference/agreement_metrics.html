<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate Agreement Metrics for Observed and Predicted Values — agreement_metrics • scatter</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate Agreement Metrics for Observed and Predicted Values — agreement_metrics"><meta name="description" content="Computes various metrics (e.g., R2, bias, RMSE) to evaluate the agreement
between observed and predicted values. Supports grouped data and includes
an option to add overall metrics for the entire dataset."><meta property="og:description" content="Computes various metrics (e.g., R2, bias, RMSE) to evaluate the agreement
between observed and predicted values. Supports grouped data and includes
an option to add overall metrics for the entire dataset."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">scatter</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calculate Agreement Metrics for Observed and Predicted Values</h1>

      <div class="d-none name"><code>agreement_metrics.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes various metrics (e.g., R2, bias, RMSE) to evaluate the agreement
between observed and predicted values. Supports grouped data and includes
an option to add overall metrics for the entire dataset.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">agreement_metrics</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">observed</span>,</span>
<span>  <span class="va">predicted</span>,</span>
<span>  add_overall <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  r2_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sum_of_squares"</span>, <span class="st">"correlation"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame or tibble containing the observed and predicted values, as well as any grouping variables.</p></dd>


<dt id="arg-observed">observed<a class="anchor" aria-label="anchor" href="#arg-observed"></a></dt>
<dd><p>The name of the column containing observed values. Must be unquoted (e.g., `observed`).</p></dd>


<dt id="arg-predicted">predicted<a class="anchor" aria-label="anchor" href="#arg-predicted"></a></dt>
<dd><p>The name of the column containing predicted values. Must be unquoted (e.g., `predicted`).</p></dd>


<dt id="arg-add-overall">add_overall<a class="anchor" aria-label="anchor" href="#arg-add-overall"></a></dt>
<dd><p>Logical, default `TRUE`. If `TRUE`, an additional row is added with overall metrics calculated for the entire dataset.</p></dd>


<dt id="arg-r-method">r2_method<a class="anchor" aria-label="anchor" href="#arg-r-method"></a></dt>
<dd><p>A character string indicating the method for calculating \(R^2\).
Options are `"sum_of_squares"` (default) for the traditional \(R^2\) based on
residual and total sums of squares, or `"correlation"` for the square of the
Pearson correlation coefficient between observed and predicted values.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A tibble containing the calculated metrics:</p><dl><dt>Grouping Variables</dt>
<dd><p>Grouping variables from the input data, if present.</p></dd>

    <dt>n</dt>
<dd><p>Number of valid (non-missing) observations used for calculations.</p></dd>

    <dt>R2</dt>
<dd><p>Coefficient of determination (R-squared).</p></dd>

    <dt>bias</dt>
<dd><p>Mean difference between predicted and observed values.</p></dd>

    <dt>bias_perc</dt>
<dd><p>Relative bias, expressed as a percentage.</p></dd>

    <dt>RMSE</dt>
<dd><p>Root Mean Squared Error.</p></dd>

    <dt>RMSE_perc</dt>
<dd><p>Relative RMSE, expressed as a percentage.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If the input data is grouped using `group_by()`, metrics are calculated separately for each group.
When `add_overall = TRUE`, a row with overall metrics (calculated on the entire dataset) is added to the result.
This function supports grouping variables of any type but ensures that grouping variables are consistently of type `character` in the output.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘dplyr’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:stats’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     filter, lag</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:base’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     intersect, setdiff, setequal, union</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example data</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"C"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"North"</span>, <span class="st">"North"</span>, <span class="st">"South"</span>, <span class="st">"South"</span>, <span class="st">"East"</span>, <span class="st">"East"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  observed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">20</span>, <span class="cn">NA</span>, <span class="fl">25</span>, <span class="fl">30</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">14</span>, <span class="fl">22</span>, <span class="cn">NA</span>, <span class="fl">23</span>, <span class="fl">28</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Grouped calculation with overall statistics</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">species</span>, <span class="va">region</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">agreement_metrics</span><span class="op">(</span>observed <span class="op">=</span> <span class="va">observed</span>, predicted <span class="op">=</span> <span class="va">predicted</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 NA value(s) were removed from the input columns in a group.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 NA value(s) were removed from the input columns in a group.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   species region      n       R2  bias bias_perc  RMSE RMSE_perc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> A       North       2    0.6     0.5      4     1.58     12.6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> B       South       1 -<span style="color: #BB0000;">Inf</span>       2       10     2        10   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> C       East        2    0.36   -<span style="color: #BB0000;">2</span>       -<span style="color: #BB0000;">7.27</span>  2         7.27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> Overall Overall     5    0.932  -<span style="color: #BB0000;">0.2</span>     -<span style="color: #BB0000;">1</span>     1.84      9.22</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Ungrouped calculation</span></span></span>
<span class="r-in"><span><span class="fu">agreement_metrics</span><span class="op">(</span><span class="va">data</span>, observed <span class="op">=</span> <span class="va">observed</span>, predicted <span class="op">=</span> <span class="va">predicted</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 NA value(s) were removed from the input columns in a group.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       n    R2  bias bias_perc  RMSE RMSE_perc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>     5 0.932  -<span style="color: #BB0000;">0.2</span>        -<span style="color: #BB0000;">1</span>  1.84      9.22</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Piotr Tompalski.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

